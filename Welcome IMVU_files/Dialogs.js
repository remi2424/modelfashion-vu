module({"@UiCore":"@UiCore","@NextUtil":"@NextUtil","css!/build/withme/Dialogs.css":"css!/asset/db2c72357220b60a/build/withme/Dialogs.css"},function(p){var u=function(){var l=Handlebars.template;Handlebars.templates=Handlebars.templates||{};return l({compiler:[5,">= 2.0.0"],main:function(d,a,e,b){var c;e=this.escapeExpression;return'<script type="text/template" class="dialog-footer-template">\n    <button class="btn btn-ghost btn-dark" data-confirm="no">'+e((c=a.no||d&&d.no,"function"===typeof c?c.call(d,{name:"no",hash:{},data:b}):c))+'</button>\n    <button class="btn btn-primary btn-dark" data-confirm="yes">'+e((c=a.yes||d&&d.yes,"function"===typeof c?c.call(d,{name:"yes",hash:{},data:b}):c))+"</button>\n<\/script>\n"},useData:!0})}({}),r=function(){var l=Handlebars.template;Handlebars.templates=Handlebars.templates||{};return l({1:function(d,a,e,b){var c;e='\n<div class="id-body-contents">';if((a=(c=a.html||d&&d.html,"function"===typeof c?c.call(d,{name:"html",hash:{},data:b}):c))||0===a)e+=a;return e+"</div>\n"},3:function(d,a,e,b){var c;e=this.escapeExpression;return'\n<p class="id-body-contents">'+e((c=a.text||d&&d.text,"function"===typeof c?c.call(d,{name:"text",hash:{},data:b}):c))+"</p>\n"},5:function(d,a,e,b){var c;e=a.helperMissing;var f=this.escapeExpression,g='\n<p class="terms-of-service">\n    <span>',h=(c=a["i18n-g"]||d&&d["i18n-g"]||e,c.call(d,"dialog_for_your_reference_terms_of_service",{name:"i18n-g",hash:{},data:b}));if(h||0===h)g+=h;g+=' <a data-external href="'+f((c=a.policyHubUrl||d&&d.policyHubUrl,"function"===typeof c?c.call(d,{name:"policyHubUrl",hash:{},data:b}):c))+'" target="_blank">';if((h=(c=a["i18n-g"]||d&&d["i18n-g"]||e,c.call(d,"Terms of Service",{name:"i18n-g",hash:{},data:b})))||0===h)g+=h;return g+"</a>.</span>\n</p>\n"},7:function(d,a,e,b){var c;e=this.escapeExpression;var f='\n<div class="dialog-checkbox-container">\n    <input id="dialog-checkbox" type="checkbox" class="checkbox" ',g=a["if"].call(d,d&&d.checkedByDefault,{name:"if",hash:{},fn:this.program(8,b),inverse:this.noop,data:b});if(g||0===g)f+=g;return f+'><label for="dialog-checkbox">'+e((c=a.checkbox||d&&d.checkbox,"function"===typeof c?c.call(d,{name:"checkbox",hash:{},data:b}):c))+"</label>\n</div>\n"},8:function(d,a,e,b){return"checked"},10:function(d,a,e,b){e='\n<div class="dialog-dropdown-container">\n    <select id="dialog-dropdown">\n        ';var c=a["if"].call(d,(c=d&&d.dropdown,null==c||!1===c?c:c.placeholder),{name:"if",hash:{},fn:this.program(11,b),inverse:this.noop,data:b});if(c||0===c)e+=c;return e+"\n    </select>\n</div>\n"},11:function(d,a,e,b){var c;a=this.escapeExpression;return'\n        <option class="dropdown-placeholder" value="" disabled selected>'+a((c=(c=d&&d.dropdown,null==c||!1===c?c:c.placeholder),"function"===typeof c?c.apply(d):c))+"</option>\n        "},compiler:[5,">= 2.0.0"],main:function(d,a,e,b){var c;e=this.escapeExpression;var f="",g=a["if"].call(d,d&&d.html,{name:"if",hash:{},fn:this.program(1,b),inverse:this.program(3,b),data:b});if(g||0===g)f+=g;f+="\n\n";if((g=a["if"].call(d,d&&d.termsOfService,{name:"if",hash:{},fn:this.program(5,b),inverse:this.noop,data:b}))||0===g)f+=g;f+="\n\n";if((g=a["if"].call(d,d&&d.checkbox,{name:"if",hash:{},fn:this.program(7,b),inverse:this.noop,data:b}))||0===g)f+=g;f+="\n\n";if((g=a["if"].call(d,d&&d.dropdown,{name:"if",hash:{},fn:this.program(10,b),inverse:this.noop,data:b}))||0===g)f+=g;return f+'\n\n<script type="text/template" class="dialog-footer-template">\n    <button class="btn btn-primary btn-dark" data-confirm="ok" disabled>'+e((c=a.ok||d&&d.ok,"function"===typeof c?c.call(d,{name:"ok",hash:{},data:b}):c))+"</button>\n<\/script>\n"},useData:!0})}({}),v=function(){var l=Handlebars.template;Handlebars.templates=Handlebars.templates||{};return l({compiler:[5,">= 2.0.0"],main:function(d,a,e,b){return'<div class="dropdown-label is-truncated"><span>&nbsp;</span></div>\n<div class="dropdown-option-list-container">\n    <div class="dropdown-scroll-up"></div>\n    <div class="dropdown-scroll-down"></div>\n    <ul class="dropdown-option-list">\n        <li class="dropdown-option is-truncated" data-value="" tabindex="-1"></li>\n    </ul>\n</div>\n'},useData:!0})}({});v=function(l){function d(b){b=$(b.target).closest(".dropdown");$(".dropdown").not(b).each(function(c,f){$(f).data("dropdown-instance").__hide()})}var a=l.UiCore.UiContext,e=l.NextUtil.Keys;return a.extend("Dropdown",{globalSetup:function(){document.addEventListener("click",d,!0);document.addEventListener("touchend",d,!0)},globalTearDown:function(){document.removeEventListener("click",d,!0);document.removeEventListener("touchend",d,!0)},uiContextName:"dropdown",className:"dropdown disable-text-selection",ITEM_HEIGHT:40,AUTO_SCROLL_BY:2,dependencies:["timer","window"],trackedEvents:function(){return[{type:"click",selector:".dropdown-label",name:"dropdown_label_click",handler:"toggleOpen"},{type:"click",selector:".dropdown-option",name:"dropdown_option_click",handler:"clickOption"},{type:"keydown",selector:"",name:"dropdown_keydown",handler:this.__onKeydown.bind(this,[])},{type:"mousemove",selector:".dropdown-option",name:"dropdown_option_mouseenter",handler:this.__onMousemove.bind(this,{x:0,y:0})},{type:"mouseenter",selector:".dropdown-label",name:"dropdown_label_mouseenter",handler:"__onMouseenterLabel"},{type:"mouseenter",selector:".dropdown-scroll-up",name:"dropdown_scroll_up_mouseenter",handler:"__onScrollUpMouseenter"},{type:"mouseleave",selector:".dropdown-scroll-up",name:"dropdown_scroll_up_mouseleave",handler:"__onScrollUpMouseleave"},{type:"mouseenter",selector:".dropdown-scroll-down",name:"dropdown_scroll_down_mouseenter",handler:"__onScrollDownMouseenter"},{type:"mouseleave",selector:".dropdown-scroll-down",name:"dropdown_scroll_down_mouseleave",handler:"__onScrollDownMouseleave"}]},__onMousemove:function(b,c){if(b.x!=c.screenX||b.y!=c.screenY)b.x=c.screenX,b.y=c.screenY,this.$el.focus(),this.setActiveElement($(c.target))},__onBlur:function(b){this.$el.removeClass("is-open")},__onMouseenterLabel:function(b){this.$(".is-selected").removeClass("is-selected")},initialize:function(b){this.$select=IMVU.requireProperty(b,"$replaceElement");if(!this.$select.is("select"))throw Error("$replaceElement must be a <select> element. got: "+this.$select[0].tagName);if(this.$select.closest("label").length)throw Error("do not wrap custom dropdowns with <label> tags; it disrupts event handling");a.prototype.initialize.call(this,b);this.window=b.window;this.timer=b.timer;this.boundingBox=b.boundingBox||this.getDefaultBoundingBox();this.document=b.document||document;this.__keyArray=[];if(this.dismissOnScroll=b.dismissOnScroll)$(b.dismissOnScroll).on("scroll.dropdown",function(){this.__hide()}.bind(this));$(".dropdown-layer").length||$("body").append('<div class="dropdown-layer"/>');this.$dropdownLayer=$(".dropdown-layer");b.dimNoValue&&this.$el.addClass("dim-no-value");b.lightText&&this.$el.addClass("light-text");b.hideArrow&&this.$el.addClass("hide-arrow");this.$el.data("dropdown-instance",this);this.addToDOM()},delete:function(){this.__keyValueArray&&this.timer.clearTimeout(this.__keyValueArray);this.dismissOnScroll&&$(this.dismissOnScroll).off("scroll.dropdown");$(this.window).off("resize.dropdown");a.prototype.delete.call(this)},__onHidden:function(){this.$el.is(":visible")&&this.remove();a.prototype.__onHidden.apply(this,arguments)},getDefaultBoundingBox:function(){var b=this.$el.position().top-5*this.ITEM_HEIGHT,c=b+11*this.ITEM_HEIGHT;0>b&&(b=0);c>$(this.window).height()&&(c=$(this.window).height());return{x:0,y:b,w:$(this.window).width(),h:c-b}},render:function(){this.$placeholder=$("<div/>");this.$el.html(l.template);this.$label=this.$(".dropdown-label");this.$optionList=this.$(".dropdown-option-list");this.$optionListContainer=this.$(".dropdown-option-list-container");var b=this.$optionList.find(".dropdown-option");this.$select.addClass("is-enhanced");this.refreshLabel(this.$select.find(":selected"));b.remove();this.$select.children().each(function(c,f){c=b.clone(!0);c.text($(f).text());c.attr("data-text",$(f).text().toLowerCase());c.attr("data-value",$(f).val());this.$optionList.append(c)}.bind(this));this.$el.addClass(this.$select[0].className).removeClass("dropdown-template").addClass("dropdown");this.$label.append(this.$select);this.$el.attr("tabindex",this.$select.attr("tabindex")||"0");this.$select.attr("tabindex",-1);this.$optionList.on("scroll",this.__onScroll.bind(this));this.$select.on("change",this.__changedOption.bind(this));this.$el.addClass("is-ready")},__fullHeight:function(){return this.$select.children().length*this.ITEM_HEIGHT},__getSelectedIndex:function(){return this.$select[0].selectedIndex},__getTopEdgeInViewport:function(b){return b.offset().top-$(this.document).scrollTop()},__getComputedInfo:function(){var b=this.__getTopEdgeInViewport(this.$el),c=this.__fullHeight(),f=this.__getSelectedIndex()*this.ITEM_HEIGHT,g=this.getDefaultBoundingBox().y,h=this.getDefaultBoundingBox().y+this.getDefaultBoundingBox().h,k=b-f,m=k+c;k<g&&(k=g);if(m>h){var q=m-h;m=h;k>g&&(k-=Math.min(k-g,q))}return{projectedTopDiff:k-b,computedHeight:m-k,selectedTop:f,maxTop:g,maxBottom:h,fullHeight:c}},__refreshScrollers:function(){var b=this.$optionList[0].scrollHeight-this.$optionList.innerHeight(),c=0<this.$optionList.scrollTop();b=Math.round(this.$optionList.scrollTop())<b;this.$el.toggleClass("can-scroll-up",c).toggleClass("can-scroll-down",b)},isOpen:function(){return this.$el.hasClass("is-open")},__hide:function(){this.isOpen()&&($(this.window).off("resize.dropdown"),this.$el.removeClass("is-open"),this.$placeholder.before(this.$el).detach(),this.$el.removeAttr("style"))},__show:function(){if(!this.isOpen()){$(this.window).on("resize.dropdown",d);var b=this.$el.offset(),c=this.$el.width(),f=this.$el.height(),g=this.$el.css("margin-left"),h=this.$el.css("margin-right"),k=this.$el.css("margin-top"),m=this.$el.css("margin-bottom"),q=this.$el.css("float");this.$placeholder.css({width:c,height:f,"margin-left":g,"margin-right":h,"margin-top":k,"margin-bottom":m,float:q});this.$el.addClass("is-open").css({top:this.__getTopEdgeInViewport(this.$el),left:b.left,width:c,height:f,"margin-left":0,"margin-right":0,"margin-top":0,"margin-bottom":0});this.$el=this.$el.before(this.$placeholder).detach();this.$dropdownLayer.append(this.$el)}},toggleOpen:function(b){this.isOpen()?this.__hide():(this.__show(),b=this.__getComputedInfo(),this.$optionListContainer.css({top:b.projectedTopDiff,height:b.computedHeight}),this.$el.focus(),b=b.selectedTop+b.projectedTopDiff,this.$optionList.scrollTop(b),this.__lastScrollTop=b,this.setActiveElement(this.$(".dropdown-option").eq(this.__getSelectedIndex())),this.__refreshScrollers());return!1},refreshLabel:function(b){this.$label.find("> span").text(b.text()).toggleClass("no-value",""===b.val())},clickOption:function(b){this.__hide();this.$select.val($(b.target).attr("data-value"));this.$select.trigger("change");d(b)},selectByValue:function(b){this.$(".is-selected").removeClass("is-selected");this.$('.dropdown-option[data-value="'+b+'"]').addClass("is-selected");this.$("select").val(b);b=this.$("select").find(":selected");this.refreshLabel(b)},val:function(){return this.$("select").val()},__changedOption:function(b){b=$(b.target).find(":selected");this.refreshLabel(b)},__maybeScrollOptionIntoView:function(b,c){if(b[0]){var f=this.$el.hasClass("can-scroll-up"),g=this.$el.hasClass("can-scroll-down"),h=this.$optionList,k=h.height(),m=h.offset().top,q=m+k,n=b.outerHeight();b=b.offset().top;var x=b+n,t=b-m+h.scrollTop(),w=k/2-n/2*3;b<m+(f?n:0)?(c&&(t-=w),h.scrollTop(t-(f?this.ITEM_HEIGHT:0))):x>q-(g?n:0)&&(c&&(t+=w),h.scrollTop(t-(k-n)+(g?n:0)))}},__open:function(b){this.isOpen()&&this.$select.val(this.$optionList.find(".is-selected").attr("data-value")).change();this.toggleOpen(b);b=this.$optionList.children().eq(this.$select[0].selectedIndex);l.NextUtil.DomHelper.radioClass(b,"is-selected");return b},__moveSelection:function(b){b=this.$optionList.children().index(this.$optionList.find(".is-selected"))+b;0>b?b=0:b>this.$select.children().length-1&&(b=this.$select.children().length-1);b=this.$optionList.children().eq(b);l.NextUtil.DomHelper.radioClass(b,"is-selected");return b},setActiveElement:function(b){this.__activeElement=b;l.NextUtil.DomHelper.radioClass(b,"is-selected")},__onKeydown:function(b,c){if(!this.isOpen()&&e.is(c,"VK_ENTER")||!this.isOpen()&&e.is(c,"VK_DOWN"))d(this.$el),this.__open(c);else{var f=this.__activeElement&&this.__activeElement.parent()[0]===this.$optionList[0]?this.__activeElement:this.$(".dropdown-option").first();if(e.is(c,"VK_DOWN"))this.__maybeScrollOptionIntoView(f.next()),f.next()[0]&&this.setActiveElement(f.next());else if(e.is(c,"VK_UP"))this.__maybeScrollOptionIntoView(f.prev()),f.prev()[0]&&this.setActiveElement(f.prev());else if(e.is(c,"VK_ENTER"))this.__hide(),this.$select.val(this.__activeElement.attr("data-value")),this.$select.trigger("change"),d(c);else if(e.is(c,"VK_ESC"))d(this.$el);else{var g=e.getAlphaNumericChar(c);if(!1!==g){var h=f[0];this.__keyValueArray&&this.timer.clearTimeout(this.__keyValueArray);b.push(g);g=b.join("").toLowerCase();for(this.__keyValueArray=this.timer.setTimeout(function(){b.length=0}.bind(this),1e3);h.nextSibling;){h=h.nextSibling;var k=$(h);if(k.attr("data-text")[0]&&l.NextUtil.string.startsWith(k.attr("data-text"),g)){this.isOpen()||this.toggleOpen(c);this.setActiveElement(k);this.__maybeScrollOptionIntoView(k,k[0]!=f[0].nextSibling&&k[0]!=f[0].prevSibling);return}}for(h=this.$(".dropdown-option")[0];h&&h!=f[0];){k=$(h);if(k.attr("data-text")[0]&&l.NextUtil.string.startsWith(k.attr("data-text"),g)){this.isOpen()||this.toggleOpen(c);this.setActiveElement(k);this.__maybeScrollOptionIntoView(k,k[0]!=f[0].nextSibling&&k[0]!=f[0].prevSibling);break}h=h.nextSibling}}}}},__onScroll:function(b){b=this.$optionList.scrollTop();this.__refreshScrollers();this.__lastScrollTop=b},__doScrollUp:function(b,c){b=this.__getComputedInfo();var f=void 0===c?this.AUTO_SCROLL_BY:c;this.$optionListContainer.offset().top+this.$optionListContainer.height()+f<b.maxBottom?(c=this.$optionListContainer.height()+f,c>b.fullHeight&&(c=b.fullHeight),this.$optionListContainer.css({height:c}),this.$optionList[0].scrollTop-=f,this.__refreshScrollers(this.$dropdown)):void 0===c&&(this.$optionList[0].scrollTop-=this.AUTO_SCROLL_BY)},__onScrollUpMouseenter:function(b){this.timer.clearInterval(this.__autoScrollInterval);this.__autoScrollIntervalCounter=0;this.__autoScrollInterval=this.timer.setInterval(function(){this.__doScrollUp(b)}.bind(this),1)},__onScrollUpMouseleave:function(b){this.timer.clearInterval(this.__autoScrollInterval)},__doScrollDown:function(b,c){b=this.__getComputedInfo();var f=void 0===c?this.AUTO_SCROLL_BY:c;if(this.$optionListContainer.offset().top-f>b.maxTop){var g=this.$optionListContainer.height()+f;c=this.$optionListContainer.position().top-f;g>b.fullHeight?g=b.fullHeight:this.$optionListContainer.css({top:c});this.$optionListContainer.css({height:g});this.$optionList[0].scrollTop+=f;this.__refreshScrollers(this.$dropdown)}else void 0===c&&(this.$optionList[0].scrollTop+=this.AUTO_SCROLL_BY)},__onScrollDownMouseenter:function(b){this.timer.clearInterval(this.__autoScrollDownInterval);this.__autoScrollDownIntervalCounter=0;this.__autoScrollDownInterval=this.timer.setInterval(function(){this.__doScrollDown(b)}.bind(this),1)},__onScrollDownMouseleave:function(b){this.timer.clearInterval(this.__autoScrollDownInterval)}})}({NextUtil:p["@NextUtil"],UiCore:p["@UiCore"],template:v});var y=function(){var l=Handlebars.template;Handlebars.templates=Handlebars.templates||{};return l({1:function(d,a,e,b){return""},3:function(d,a,e,b){return" no-header"},5:function(d,a,e,b){var c,f=a.helperMissing;e='\n            <div class="wh-20">';if((a=(c=a.icon||d&&d.icon||f,c.call(d,"icon-chatwindow_close",{name:"icon",hash:{class:"wh-full"},data:b})))||0===a)e+=a;return e+"</div>\n        "},7:function(d,a,e,b){var c,f=a.helperMissing;e='\n            <div class="wh-20">';if((a=(c=a.icon||d&&d.icon||f,c.call(d,"icon-dialog_close",{name:"icon",hash:{class:"wh-full"},data:b})))||0===a)e+=a;return e+"</div>\n        "},compiler:[5,">= 2.0.0"],main:function(d,a,e,b){var c;e=a.helperMissing;var f=this.escapeExpression,g='<div class="dialog-container ',h=a["if"].call(d,d&&d.headerIsVisible,{name:"if",hash:{},fn:this.program(1,b),inverse:this.program(3,b),data:b});if(h||0===h)g+=h;g+='">\n    <a href="#" class="dialog-x">\n        ';if((h=(c=a.platform||d&&d.platform||e,c.call(d,"mobile",{name:"platform",hash:{},fn:this.program(5,b),inverse:this.program(7,b),data:b})))||0===h)g+=h;return g+'\n    </a>\n    <header class="dialog-header">\n        <h3 class="dialog-title nowrap">'+f((c=a.title||d&&d.title,"function"===typeof c?c.call(d,{name:"title",hash:{},data:b}):c))+'</h3>\n    </header>\n    <div class="aux-header"></div>\n    <section class="dialog-body"></section>\n    <footer class="dialog-footer"></footer>\n</div>\n'},useData:!0})}({}),z=function(l){var d=l.UiCore.UiContext;return d.extend("UIContextExtension",{dependencies:"browserInfo currentLocale featureAccessManager loginManager timestampHelper window".split(" "),initialize:function(a){d.prototype.initialize.call(this,a);this.__appMonitor=null;this.__browserInfo=a.browserInfo;this.__featureAccessManager=a.featureAccessManager;this.__loginManager=a.loginManager;this.__timestampHelper=a.timestampHelper;this.__currentLocale=this.__currentLocale||"en";this.__currentLocale="www"===this.__currentLocale?"en":this.__currentLocale;this.serviceProvider=a.serviceProvider;this.__userIsLoggedIn=this.__loginManager.isLoggedIn();this.__myCid=0;this.__userIsLoggedIn&&(this.__myself=this.__loginManager.getCurrentUser(),this.__loginType=this.__loginManager.getLoginType(),this.__myself.populated().then(function(){this.__myCid=this.__myself.get("legacy_cid");if("string"===typeof this.__myCid)if(/^\d+$/.test(this.__myCid))this.__myCid=parseInt(this.__myCid);else{if(!this.__appMonitor&&this.serviceProvider.has("appMonitor")){var e=this.serviceProvider.get("appMonitor");e&&(this.__appMonitor=e)}this.__appMonitor?this.__appMonitor.reportCustomError("UIContextExtension","initialize","web_perm_0017","Bad CID detected",["Suspect CID["+this.__myCid+"]","this.__mySelf...",JSON.stringify(this.__myself)]):this.__window.appMonitorPending.push(["UIContextExtension","initialize","web_perm_0017","Bad CID detected",["Suspect CID["+this.__myCid+"]","this.__mySelf...",JSON.stringify(this.__myself)]]);this.__myCid=0}this.__myCid=this.__myCid?this.__myCid:0;this.__myCountry=this.__myself.get("country")}.bind(this)));this.__perfReportManager=this.serviceProvider.get("perfReportManager");this.__perfReportManager.setUIContext(this)},getActivityGroupID:function(){return this.__activityGroup.id},getClientSessionID:function(){},packageAppDeviceData:function(){var a=this.__browserInfo.getPlatformData();return{is_test_data:String(this.__window.location).includes("localhost")?"test":"production",app_instance_id:a.appInstanceID,device_platform:a.devicePlatform,device_model:a.deviceModel,app_version:a.appVersion,customer_id:this.__myCid}},__packageEventData:function(a,e){var b=this.__timestampHelper.now().unix().toString();return _.extend({event:null,event_class:null,event_transaction_id:e,event_timestamp:b,event_source:"user",event_reason:null,location:null},a)},__packageTaxonomyData:function(a,e){return{payload_format:"taxonomy",taxonomy:{tenant_id:"IMVU",schema_version:1,app_device_data:this.packageAppDeviceData(),event_data:this.__packageEventData(a,e)}}},__recordTaxonomyEvent:function(a,e){var b=l.NextUtil.DomHelper.createGUID();a=this.__packageTaxonomyData(a,b);this.__recordEvent("taxonomy",a,e||"","soma_taxonomy");return b},recordSentWhisper:function(a){return this.__recordTaxonomyEvent({event:"whisper_sent",event_class:"chat",event_reason:"click",string_one:navigator.language,integer_one:a.receiverCid,integer_two:a.senderVipStatus,integer_three:a.receiverVipStatus,location:a.location,level_one:a.roomType,level_two:a.roomId,level_three:a.startOrReply,client_ip:a.clientIp})},recordShowTieredVipUpsell:function(a){return this.__recordTaxonomyEvent({event:"vip_upsell",event_class:"vip",event_reason:"click",string_one:navigator.language,string_two:a.vipTriggerLocation,event_source:"user",location:a.vipTrigger,user_agent:navigator.userAgent,client_ip:a.clientIp})},recordYouTubePlaylistClick:function(a){var e=a.playlistId;e.includes("list=")&&(e=e.split("list=")[1]);return this.__recordTaxonomyEvent({event:"youtube_imvu_curated_playlist_started",event_class:"youtube",event_reason:"click",string_one:e,client_ip:a.clientIp})},recordYouTubeSearch:function(a){return this.__recordTaxonomyEvent({event:"youtube_video_search",event_class:"youtube",event_reason:"click",string_one:a.searchString,client_ip:a.clientIp})},recordGuestExperiencesYouTube:function(a){var e=parseInt(a.hostCid.match(/\d+$/)[0],10);return this.__recordTaxonomyEvent({event:"youtube_video_viewed_by_non_host",event_class:"youtube",event_reason:a.alreadyPlaying?"playing":"started",integer_one:e,level_one:a.roomId,client_ip:a.clientIp})},recordProductTaxonomyEvent:function(a,e){a=a.get("product_id");if("number"!==typeof a||0>=a)return null;e.systemError=""===e.systemError?null:e.systemError;var b=a.toString(),c={event:IMVU.requireProperty(e,"event"),event_class:IMVU.requireProperty(e,"eventClass"),event_reason:IMVU.requireProperty(e,"eventReason"),location:IMVU.requireProperty(e,"location"),string_one:IMVU.requireProperty(e,"status")};"product_purchased"===e.event?(c.string_two=IMVU.requireProperty(e,"currencyType"),c.string_three=IMVU.requireProperty(e,"systemError"),c.string_four=this.__loginType,c.string_five=this.__getLanguangeSetting()):(c.string_two=IMVU.requireProperty(e,"systemError"),c.integer_one=a);return this.__recordTaxonomyEvent(c,b)},recordPerformanceTaxonomyEvent:function(a,e,b){if(-1===this.__perfReportManager.getBudget(a))return this.__window.console.error("UIContextExtension::recordPerformanceTaxonomyEvent - tage("+String(a)+") not recognized"),null;var c=this.__perfReportManager.getBudget(a);b=b||{};b.submode="__default__"===b.submode?"default":b.submode;var f=IMVU.optionalProperty(b,"northstar",null);f=f?JSON.stringify(f):"";var g=this.__serviceProvider.get("systemMetrics");g=g?JSON.stringify(g):"";var h=this.__featureAccessManager.getMarketingPlatform(),k=this.__serviceProvider.get("appVersion"),m=0,q=0,n=0;"@DEV"===k?h="desktop-client-dev":k&&(h="desktop-client-"+k,n=k.split("."),m=parseInt(n[0]),q=parseInt(n[1]),n=parseInt(n[2]));k=this.__serviceProvider.get("appName");a=a+"__"+h+"__"+k+"__"+(b.type+"_Mode-"+b.mode+"_Submode-"+b.submode);h=-1;"undefined"===typeof b.sessionDuration?this.__window.console.error("UiContextExtension::recordPerformanceTaxonomyEvent - Event data missing sessionDuration"):h=b.sessionDuration;return this.__recordTaxonomyEvent({event:"performance",event_class:"measurement",event_reason:"dna",location:"dna",decimal_one:c,decimal_two:e,string_one:a,string_two:f,string_three:g,integer_one:m,integer_two:q,integer_three:n,integer_four:h},"")},__getLanguangeSetting:function(){return this.__currentLocale+"-"+this.__myCountry}})}({NextUtil:p["@NextUtil"],UiCore:p["@UiCore"]});p=function(l){var d=l.UIContextExtension;return d.extend("AlloyModalDialog",{uiContextName:"modal_dialog_alloy",className:"alloy-modal-dialog",dependencies:["appMonitor","globalStringManager","nextRoot","Promise","window"],hasCloseButton:!0,headerIsVisible:!0,contentAreas:{header:".dialog-header",auxHeader:".aux-header",body:".dialog-body",footer:".dialog-footer"},initialize:function(a){d.prototype.initialize.call(this,a);"undefined"!==typeof a.hasCloseButton&&(this.hasCloseButton=a.hasCloseButton);"undefined"!==typeof a.headerIsVisible&&(this.headerIsVisible=a.headerIsVisible);this.serviceProvider=a.serviceProvider;this.__appMonitor=a.appMonitor;this.dialogManager=a.dialogManager;this.__stringManager=a.globalStringManager;this.__nextRootBase=this.__nextRoot.replace("/next/","");this.__postToParent="undefined"===typeof a.postToParent?!0:a.postToParent;this.canCloseWithOverlayClick=IMVU.optionalProperty(a,"canCloseWithOverlayClick",!0);this.__appMonitor.waypoint("AlloyModalDialog::initialize:"+this.constructor.name);this.finished=new a.Promise(function(e){this.promiseResolver=e}.bind(this));this.shouldFocusOnPrimaryButton=!0;a=this.delete.bind(this);this.finished.then(a,a);this.$el.attr("data-ui-role","modal-dialog");this.$el.on("focusin",function(e){this.$el.closest("html").addClass("dialog-focused")}.bind(this));this.$el.on("focusout",function(e){this.$(e.target).closest(".dropdown").length||this.$el.closest("html").removeClass("dialog-focused")}.bind(this));this.$el.trigger("focusout");this.__postToParent&&this.__window.parent&&this.__window.parent.postMessage&&this.__window.parent.postMessage({message:"opening_modal_dialog",type:this.uiContextName},"*")},render:function(){var a=this;this.doWork([function(){a.$el.html(l.template({title:a.title||"",headerIsVisible:a.headerIsVisible}));a.$(".dialog-x").on("click",a.__onClose.bind(a));a.$el.toggleClass("can-dismiss",a.hasCloseButton);a.postRender();a.$el.closest("html").attr("data-dialog",a.uiContextName);a.__focusPrimaryButton();a.$el.is(".dialog-type-B, .dialog-type-B-flexible")&&a.$el.closest("body").is(".mobile")&&470>a.$el.width()&&(a.$el.is(".text-close")?a.$(".dialog-x").text("Close"):a.$el.is(".text-done")?a.$(".dialog-x").text("Done"):a.$el.is(".text-none")?a.$(".dialog-x").text(""):a.$(".dialog-x").text("Cancel"),a.__adjustTitlePosition())}])},__adjustTitlePosition:function(){this.$(".dialog-title").removeClass("overflowed");var a=this.$(".dialog-title").width(),e=this.$(".dialog-header").width();a<=e-160?this.$(".dialog-title").toggleClass("overflowed",!1):this.$(".dialog-title").toggleClass("overflowed",!0)},linkToDetailsSubmode:function(a,e){this.serviceProvider.get("historyManager").setState({fragment:this.__urlId(e.id),mode:{id:a},submode:{id:e.id,summary:{model:e}}})&&(a=function(){this.serviceProvider.get("historyManager").silentMoveHistory(-1)}.bind(this),this.finished.then(a,a))},show:function(){this.__appMonitor.waypoint("AlloyModalDialog::show:"+this.constructor.name);d.prototype.show.call(this);this.__focusPrimaryButton()},hide:function(){this.__appMonitor.waypoint("AlloyModalDialog::hide:"+this.constructor.name);d.prototype.hide.call(this);this.$el.closest("html").removeAttr("data-dialog")},close:function(){this.__appMonitor.waypoint("AlloyModalDialog::close:"+this.constructor.name);this.hide();this.promiseResolver.reject()},closeAll:function(a){a.preventDefault();this.__recordEvent("click",{name:"dialog_close"});this.__dialogManager.closeAll()},showHeader:function(){this.headerIsVisible=!0;this.$(".dialog-container").removeClass("no-header")},hideHeader:function(){this.headerIsVisible=!1;this.$(".dialog-container").addClass("no-header")},toggleHeader:function(){this.headerIsVisible?this.hideHeader():this.showHeader()},__onClose:function(a){a.preventDefault();this.__recordEvent("click",{name:"dialog_close"});this.close()},__focusPrimaryButton:function(){if(this.shouldFocusOnPrimaryButton){var a=this.$(".btn-primary");1<a.length?a.trigger("blur"):a.first().focus()}},updateDialogTitle:function(a){this.$(".dialog-header .dialog-title").text(a);this.__adjustTitlePosition()},delete:function(){this.__appMonitor.waypoint("AlloyModalDialog::delete:"+this.constructor.name);this.__postToParent&&this.__window.parent&&this.__window.parent.postMessage&&this.__window.parent.postMessage({message:"deleting_modal_dialog",type:this.uiContextName},"*");d.prototype.delete.call(this)}})}({UiCore:p["@UiCore"],UIContextExtension:z,template:y});r=function(l){var d=l.AlloyModalDialog;return d.extend("AlloyAlertDialog",{uiContextName:"alert_dialog_alloy",className:"alert-dialog-alloy",dependencies:["externalNextRoot"],trackedEvents:function(){return[{type:"click",selector:'[data-confirm="ok"]',name:"confirm",handler:"__onConfirm"},{type:"change",selector:"#dialog-dropdown",name:"option",handler:"__toggleConfirmButton"}]},initialize:function(a){this.title=a.title;this.text=a.text;this.html=a.html;this.darkText=IMVU.optionalProperty(a,"dark_text",!1);d.prototype.initialize.call(this,a);this.ok=a.ok||this.__stringManager.get("OK");this.checkbox=a.checkbox;this.dropdown=a.dropdown;this.termsOfService=a.termsOfService;this.checkedByDefault=_.isUndefined(a.checkedByDefault)?!0:a.checkedByDefault;this.addToDOM()},postRender:function(){this.setContent("body",l.template,{text:this.text,html:this.html,ok:this.ok,checkbox:this.checkbox,dropdown:this.dropdown,termsOfService:this.termsOfService,checkedByDefault:this.checkedByDefault,policyHubUrl:this.__externalNextRoot+"policyhub/"});this.setContent("footer",this.$(".dialog-footer-template").last().text());this.$("#dialog-dropdown").length&&(_.each(this.dropdown.options,function(a){this.$("#dialog-dropdown").append('<option value="'+a.value+'">'+a.label+"</option>")}.bind(this)),this.reasonDropDown=this.createChildContext(l.Dropdown,{$replaceElement:this.$("#dialog-dropdown")}));this.$(".dialog-title").toggleClass("long-title",this.title&&19<this.title.length);this.darkText&&this.$el.addClass("dark-text");this.__toggleConfirmButton()},getResult:function(){var a={},e=this.$("#dialog-checkbox"),b=this.$("#dialog-dropdown");e.length&&(a.checked=e.is(":checked"));b.length&&(a.dropdown=b.val());return a},__onConfirm:function(){this.$(".btn-primary").prop("disabled",!0);this.promiseResolver.resolve(this.getResult());this.hide()},__toggleConfirmButton:function(){this.$("#dialog-dropdown").length?this.$(".btn-primary").prop("disabled",!this.$("#dialog-dropdown").val()):this.$(".btn-primary").prop("disabled",!1)}})}({AlloyModalDialog:p,Dropdown:v,template:r});u=function(l){var d=l.AlloyAlertDialog;return d.extend("AlloyConfirmDialog",{uiContextName:"confirm_dialog_alloy",className:"confirm-dialog-alloy",trackedEvents:function(){return[{type:"click",selector:'[data-confirm="yes"]',name:"confirm",handler:"__onConfirm",attributes:{which:this.__confirmDialogType}},{type:"click",selector:'[data-confirm="no"]',name:"deny",handler:"__onDeny",attributes:{which:this.__confirmDialogType}}]},initialize:function(a){a.title=a.title;a.text=a.text;this.yes=a.yes;this.no=a.no;this.__confirmDialogType=a.confirmDialogType;this.darkText=IMVU.optionalProperty(a,"dark_text",!1);this.eventAttributes=IMVU.optionalProperty(a,"eventAttributes",{});d.prototype.initialize.call(this,a)},postRender:function(){d.prototype.postRender.call(this);this.$el.attr("data-type","confirm");this.setContent("body",l.template,{yes:this.yes,no:this.no});var a=this.$(".dialog-footer-template");this.$(".dialog-footer").html("");this.setContent("footer",a.last().text());this.darkText&&this.$el.addClass("dark-text")},__onConfirm:function(){var a=_.extend(this.getResult(),{confirm:"yes"});this.promiseResolver.resolve(a);this.hide()},__onDeny:function(){var a=_.extend(this.getResult(),{confirm:"no"});this.promiseResolver.reject(a);this.hide()},__getUiAttributes:function(a){return _.extend(this.eventAttributes,d.prototype.__getUiAttributes.call(this,a))}})}({AlloyAlertDialog:r,template:u});return{AlloyAlertDialog:r,AlloyConfirmDialog:u,AlloyModalDialog:p}});